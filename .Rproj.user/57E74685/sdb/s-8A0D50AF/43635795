{
    "contents" : "# Loading required packages\n\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n# library(reshape2)\nlibrary(stringr)\nlibrary(plyr)\nlibrary(googleVis)\nlibrary(ggmap)\nlibrary(Hmisc)\nlibrary(shiny)\nlibrary(shinyapps)\nlibrary(rCharts)\n\n.simpleCap <- function(x) {\n  s <- strsplit(x, \" \")[[1]]\n  paste(toupper(substring(s, 1, 1)), substring(s, 2),\n        sep = \"\", collapse = \" \")\n}\n\nsetwd(\"~/Dropbox/Documents/MOOC/Datasets/Santa-Clara-County-Housing-Explorer\")\n\nFName <- list.files(path = \"../Redfin-unused files/raw\", pattern = '.*\\\\.csv', full.names = TRUE, recursive = TRUE)\n\nldf <- lapply(FName, function(x) read.csv(x, stringsAsFactors = F))\n\ndata <- rbind.fill(ldf)\ndata2 <- rbind.fill(ldf)\nhead(as.character(data$ADDRESS))\nrm(FName, ldf)\n\nstr(data)\nnames(data) <- tolower(names(data))\ndata$last.sale.date <- as.Date(data$last.sale.date)\ntable(data$location)\n\n# Just use the data for the past from July 2011 onwards\ndata <- subset(data, last.sale.date >= as.Date(\"2012-07-01\"))\n\nnames(data)[25] <- \"redfinUrl\"\nnames(data)\n\nlength(unique(data$redfinUrl))\nlength(unique(data$address))\ntable(!duplicated(data$redfinUrl))\ntable(!is.na(data$redfinUrl))\n\nsummary(nchar(data$redfinUrl))\nhist(nchar(data$redfinUrl))\n\ndata <- subset(data, !duplicated(data$redfinUrl))\ntable(data$home.type, useNA = 'ifany')\ndata <- subset(data, !home.type %in% c(\"\", \"Unknown\", \"Vacant Land\"))\ndata[data$home.type %in% c(\"Multi-Family (5+ Unit)\", \"Multi-Family (2-4 Unit)\"),]$home.type <- \"Multi-Family\"\nstr(data)\n\ndata$home.type <- factor(data$home.type, levels = c(\"Condo/Coop\", \"Townhouse\", \"Single Family Residential\", \"Mobile/Manufactured Home\", \"Multi-Family\"))\n\ntable(data$city, useNA = 'ifany')\ndata$city <- tolower(data$city)\ndata$city <- capitalize(data$city)\n\ndata$city <- gsub(\"East palo alto\", \"East Palo Alto\", data$city)\ndata$city <- gsub(\"Los altos\", \"Los Altos\", data$city)\ndata$city <- gsub(\"Los Altos hills\", \"Los Altos Hills\", data$city)\ndata$city <- gsub(\"Los gatos\", \"Los Gatos\", data$city)\ndata$city <- gsub(\"Los Gatos mtns\", \"Los Gatos\", data$city)\ndata$city <- gsub(\"Los Gatos scz\", \"Los Gatos\", data$city)\ndata$city <- gsub(\"Mountain view\", \"Mountain View\", data$city)\ndata$city <- gsub(\"Palo alto\", \"Palo Alto\", data$city)\ndata$city <- gsub(\"San jose\", \"San Jose\", data$city)\ndata$city <- gsub(\"Santa clara\", \"Santa Clara\", data$city)\ndata <- subset(data, ! city %in% c(\"\", \"Alviso\", \"Avila Beach\", \"Carmel\", \"La Honda\", \"Menlo park\", \"Monte sereno\", \"Morgan hill\", \"Out of area\", \"Stanford\", \"Unknown\", \"Woodside\"))\n\nsummary(data$sqft)\nsummary(data)\nnames(data)\n\naryVarName <- c(6, 8, 9, 11, 13, 24, 31, 32)\nnames(data)[aryVarName]\nsummary(data[,aryVarName])\ndata <- data[complete.cases(data[,aryVarName]),]\n\ntable(data$state)\ntable(data$zip)\ndata <- subset(data, zip != 0)\n\ntable(data$beds)\ndata <- subset(data, beds != 0)\ndata[which.max(data$beds),]\n\ntable(data$baths)\nqplot(data = data, x = beds, y = baths, color = home.type, geom = 'point')\ndata <- subset(data, baths <= 15)\n\nsummary(data$sqft)\nsummary(data$lot.size)\ndata[which.max(data$lot.size),]$lot.size\ndata[with(data, order(-lot.size)),][c(1:5),]\n\n# data[which.max(data$lot.size),]$lot.size <- 6651\ndata[which.max(data$lot.size),]\ndata[with(data, order(-lot.size)),][c(1:50),]$lot.size <- as.numeric(\"\")\nqplot(data = subset(data, home.type != \"Single Family Residential\"), x = last.sale.price, y = lot.size, color = home.type, geom = 'point')\n\nnames(data)\nsummary(data$last.sale.date)\n\nhead(data[with(data, order(year.built)),])\ndata[which.min(data$year.built),]$year.built\n# data[grep(\"PARK VILLA Cir\", data$address),]$year.built\n# data[which.min(data$year.built),]$year.built <- 1972\n\nsummary(data$last.sale.price)\nhead(data[with(data, order(-last.sale.price)),])\ndata[which.max(data$last.sale.price),]$last.sale.price <- 1400000\nqplot(data = data, x = last.sale.price, geom = 'histogram', xlim = c(0, 3000000), binwidth = 10000)\n\n# Adding some new metrics\n\ndata$price.sqft <- data$last.sale.price / data$sqft\n\nsummary(data$price.sqft)\nhead(data[with(data, order(-price.sqft)),])\n\nhead(data[with(data, order(-sqft)),])\ndata[data$redfinUrl == \"http://www.redfin.com/CA/San-Jose/38-N-Almaden-Blvd-95110/unit-1606/home/17289034\",]$sqft <- 1400\n\nsaveRDS(data, \"housingData.RDS\")\n\nhousingData <- readRDS(\"housingData.RDS\")\n\n# housingData$last.sale.qtr <- as.yearqtr(housingData$last.sale.date)\n# ddply(housingData, .(home.type, last.sale.qtr), summarise, last.sale.price = median(last.sale.price))\n\n# data$LatLong <- paste0(data$latitude, \":\", data$longitude)\n\n# table(data$location)\n\n# table(data$location, data$zip)\n\nMtView12 <- qmap(\"Mountain View, CA\", zoom = 12, color = \"bw\", legend = \"bottomleft\")\nMtView13 <- qmap(\"Mountain View, CA\", zoom = 13, color = \"bw\", legend = \"bottomleft\")\nMtView14 <- qmap(\"Mountain View, CA\", zoom = 14, color = \"bw\", legend = \"bottomleft\")\n\np <- MtView12\n# p <- p + geom_point(data = subset(data, last.sale.price > 1000000), aes(x = longitude, y = latitude, color = home.type), size = 2, alpha = 0.5)\np <- p + geom_point(data = subset(data), aes(x = longitude, y = latitude, color = home.type), alpha = 0.2, size = 1)\np <- p + scale_color_brewer(palette = \"Set1\")\np\n\np <- MtView13\n# p <- p + geom_point(data = subset(data, last.sale.price > 1000000), aes(x = longitude, y = latitude, color = home.type), size = 2, alpha = 0.5)\np <- p + geom_point(data = subset(data), aes(x = longitude, y = latitude, color = factor(zip)), alpha = 0.5)\np <- p + scale_color_brewer(palette = \"Set1\")\np\n\n\n\n# Figuring out zip codes\n\nlibrary(zipcode)\nlibrary(ggplot2)\n\ndata(zipcode)\nzipcode$region = substr(zipcode$zip, 1, 1)\nstr(zipcode)\n\nSFBay <- qmap(\"san francisco bay area\", zoom = 10, color = \"bw\", legend = \"bottomleft\")\n\ng = ggplot(data=subset(zipcode, zip %in% as.character(seq(94022, 95196, 1)))) + geom_point(aes(x=longitude, y=latitude, colour=region))\n# g = g + theme_bw() + scale_x_continuous(limits = c(-125,-66))\n# g = g + scale_y_continuous(limits = c(25,50))\ng = g + coord_fixed(ratio = 1)\ng = g + labs(x=NULL, y=NULL)\ng\n\nstr(housingData)\n\np <- ggplot(data = subset(housingData, beds >=1 & beds <= 4 & home.type != \"Multi-Family\" & last.sale.date >= as.Date(\"2010-01-01\") & last.sale.date <= Sys.Date())) + theme_bw()\n# p <- p + geom_point(aes(x = as.Date(last.sale.date), y = last.sale.price, color = factor(beds)))\np <- p + geom_smooth(aes(x = as.Date(last.sale.date), y = last.sale.price, color = factor(beds)))\np <- p + facet_wrap( ~ home.type, scales = \"free_y\")\n# p <- p + coord_cartesian(ylim = c(0, 3000000))\np <- p + scale_x_date(labels = date_format(\"%Y-%m\"))\np <- p + scale_y_continuous(labels = dollar)\np <- p + scale_color_brewer(palette = \"Set1\")\np <- p + xlab(\"Last Sale Date\") + ylab(\"Last Sale Price\")\np\n",
    "created" : 1410532593643.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "803351531",
    "id" : "43635795",
    "lastKnownWriteTime" : 1410660139,
    "path" : "~/Dropbox/Documents/MOOC/Datasets/Redfin-unused files/redfin.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}